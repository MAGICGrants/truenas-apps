groups:
  - name: Monero Node
    description: Configure Monero Node
  - name: Monero Wallet RPC
    description: Configure Monero Wallet
  # TODO
  # - name: Onion Monero Explorer
  #   description: Configure Onion Monero Explorer
  # - name: Networking
  #   description: Configure Networking

questions:
  - variable: node
    label: ""
    group: Monero Node
    schema:
      type: dict
      attrs:
        - variable: enabled
          label: Enabled
          description: |
            Run a Monero node with this app. This is strongly recommended to provide the best privacy and security.
          schema:
            type: boolean
            required: true
            default: false
        - variable: pruned
          label: Prune the blockchain
          description: |
            A pruned Monero blockchain will take up about 1/3rd the storage space of an unpruned node. If you have the extra space and wish to contribute more resources to the Monero network, consider disabling the prune option. A pruned node provides nearly all of the advantages of an unpruned node, so if you are unsure, leave this option enabled.
          schema:
            type: boolean
            required: true
            default: true
            show_if: [["enabled", "=", true]]
        - variable: publicly_available
          label: Advertise as a publicly-available
          description: |
            If you wish to make it easier for other people to communicate with your node, enable this option. If you are unsure, leave this option disabled.
          schema:
            type: boolean
            required: true
            default: false
            show_if: [["enabled", "=", true]]
        - variable: dns_blocklist
          label: Enable community DNS blocklist
          description: |
            Unless you have a good reason to disable this option, leave this option enabled.
          schema:
            type: boolean
            required: true
            default: true
            show_if: [["enabled", "=", true]]
        - variable: logging
          label: Enable logging
          description: |
            Unless you encounter an issue and wish to review the logs, leave this option disabled.
          schema:
            type: boolean
            required: true
            default: false
            show_if: [["enabled", "=", true]]
        - variable: log_file_path
          label: Log file location
          schema:
            type: path
            required: true
            show_if: [["enabled", "=", true], ["logging", "=", true]]
        - variable: additional_flags
          label: Additional flags
          description: |
            Additional monerod commands can be provided here. If you are unsure, leave this blank. Reference: https://docs.getmonero.org/interacting/monerod-reference/#options
          schema:
            type: string
            required: false
        - variable: blockchain_path
          label: Blockchain storage location
          description: |
            This MUST be SSDs for reasonable performance. You will have a very bad time trying to sync a Monero node on HDDs. We recommend at least 200GB of free space if pruning is enabled and at least 500GB if pruning is disabled.
          schema:
            type: path
            required: true
            show_if: [["enabled", "=", true]]

        - variable: remote_node_url
          label: Remote node URL
          description: |
            If you do not run a Monero node, you need to point to a different Monero node for the other applications to work. Ideally this should be another device that you run, but it can be a node run by a third-party. Although the Monero software will take certain steps to protect your privacy and security when connecting to a third-party node, there are still meaningful privacy and security disadvantages.
          schema:
            type: string
            required: true
            show_if: [["enabled", "=", false]]
        - variable: ssl_enabled
          label: Enable SSL
          description: |
            Encrypt the connection between this device and the remote Monero node that you have selected. Generally this should be disabled when connecting to other Monero nodes on the same network. If you connect to a third-party node on a different network without SSL, your internet service provider can see your communications with this node which is bad for privacy.
          schema:
            type: boolean
            required: true
            default: true
            show_if: [["enabled", "=", false]]
        - variable: trust_daemon
          label: Trust this daemon
          description: |
            If you are connecting to a third-party node or are unsure, leave this disabled. If you are connecting to a node that you operate (or substantially trust), then enable this option to speed up certain functions.
          schema:
            type: boolean
            required: true
            default: false
            show_if: [["enabled", "=", false]]

  - variable: wallet
    label: ""
    group: Monero Wallet RPC
    schema:
      type: dict
      attrs:
        - variable: enabled
          label: Enabled
          description: |
            Monero Wallet RPC is a Monero wallet that can be interacted with via RPC commands. Enable this if you want a Monero wallet to run on this device. You do not need this if you want to simply run a node and connect to this node from a different wallet (e.g. a mobile or desktop wallet).
          schema:
            type: boolean
            required: true
            default: false
        - variable: wallet_path
          label: Wallet storage location
          schema:
            type: path
            required: true
            show_if: [["enabled", "=", true]]
        - variable: port
          label: Port
          schema:
            type: int
            required: true
            default: 18083
            $ref:
              - definitions/port
            show_if: [["enabled", "=", true]]

  # TODO
  # - variable: explorer
  #   label: ""
  #   group: Onion Monero Explorer
  #   schema:
  #     type: dict
  #     attrs:
  #       - variable: enabled
  #         label: Enabled
  #         schema:
  #           type: boolean
  #           required: true
  #           default: false
  #       - variable: api_enabled
  #         label: API enabled
  #         schema:
  #           type: boolean
  #           required: true
  #           default: true
  #           show_if: [["enabled", "=", true]]
  #       - variable: additional_flags
  #         label: Additional flags (https://github.com/moneroexamples/onion-monero-blockchain-explorer?tab=readme-ov-file#the-explorers-command-line-options)
  #         schema:
  #           type: string
  #           required: false
  #           show_if: [["enabled", "=", true]]

  - variable: networking
    label: ""
    group: Networking
    schema:
      type: dict
      attrs:
        - variable: ipv6_enabled
          label: Enable IPv6
          schema:
            type: boolean
            required: true
            default: false
        - variable: tor_connections_enabled
          label: Enable Tor connections
          schema:
            type: boolean
            required: true
            default: false
        - variable: tor_ip
          label: Tor IP
          description: Enter the local IP of this machine if you are running the Arti TrueNAS app.
          schema:
            type: string
            required: true
            $ref:
              - definitions/node_bind_ip
            show_if: [["tor_connections_enabled", "=", true]]
        - variable: tor_port
          label: Tor port
          schema:
            type: int
            required: true
            $ref:
              - definitions/port
            show_if: [["tor_connections_enabled", "=", true]]
        - variable: routing
          label: Route all traffic through
          schema:
            type: string
            required: true
            default: clearnet
            enum:
              - value: clearnet
                description: Clearnet (no proxy)
              - value: tor
                description: Tor
            show_if: [["tor_connections_enabled", "=", true]]
        # TODO
        # - variable: i2p_connections_enabled
        #   label: Enable I2P connections
        #   schema:
        #     type: boolean
        #     required: true
        # - variable: i2p_ip
        #   label: I2P IP
        #   schema:
        #     type: string
        #     required: true
        #     $ref:
        #       - definitions/node_bind_ip
        #     show_if: [["i2p_connections_enabled", "=", true]]
        # - variable: i2p_port
        #   label: I2P port
        #   schema:
        #     type: int
        #     required: true
        #     $ref:
        #       - definitions/port
        #     show_if: [["i2p_connections_enabled", "=", true]]
